# BakeCake Bot

---
Телеграм-бот для приема заказов на торты в г. Москва!

Демо:
- [Бот](https://t.me/bakeyourcakebot)
- [Админский канал](https://t.me/+sbEwmTN1hEFmYjYy), где бот постит заказы.
- [Админка](http://193.168.49.50:8000/admin/). Логин: guest1, пароль: guest. 

Проект состоит из 2 компонент:
1. Админка Django (для управления всем) + БД
2. Телеграм-бот

Функционал пользователя:
- Выбор торта
- Создание кастомного торта
- Оформление заказа

Функционал администратора:
- Редактирование ингредиентов и их наличия
- Редактирования тортов
- Просмотр заказов и данных о клиентах
- Отдельный тг-канал, в который будут сыпаться новые заказы, как только они оформлены
- Создание сокращённых ссылок на бота и подсчёт переходов по ним

Нижеследующие инструкции описывают, как развернуть проект на локальной машине.

## Установка зависимостей
Первым делом, скачайте код:
``` 
git clone https://github.com/KillerBee88/BakeCake.git
```
Установите необходимые зависимости командой:
```
pip install -r requirements.txt
```

## Переменные окружения

Для работы проекта, в корень необходимо положить файл `.env` со следующими полями:

Переменные, необходимые для работы Телеграм-бота:
- `TG_BOT_TOKEN` - токен Вашего Телеграм-бота. [Как создать бота и получить токен](https://core.telegram.org/bots#how-do-i-create-a-bot).
- `TG_CHANNEL_ID` - id Вашего канала, куда будут приходить уведомления о новых заказах.
- `BITLY_TOKEN` - Ваш токен с сайта Bitly. [Как получить?](https://github.com/pas-zhukov/bitlink#получение-токена)
- `BOT_LINK` - ссылка на Вашего бота в телеграм, используется для создания сокращённых ссылок. Пример: https://t.me/bakeyourcakebot


## Запуск админки

Для того, чтобы работал бот, необходимо развернуть django проект.

1. Создаем миграции командой
```shell
python manage.py makemigrations
```

2. Применяем миграции
```shell
python manage.py migrate
```

3. Собираем статику
```shell
python manage.py collectstatic
```

4. Создаём суперпользователя

```shell
python manage.py createsuperuser
```

5. Запускаем dev сервер
```shell
python manage.py runserver
```

6. Переходим по адресу http://127.0.0.1:8000/admin/ и заходим в кабинет администратора.

Минимальный набор данных для проверки бота: создать по одному объекту в каждой таблице ингредиентов торта, сделать их доступными. Создать один оригинальный торт.

## Запуск бота

1. Создать бота, поместить токен в `.env` (см. инструкцию выше).
2. Создать Telgram-канал, поместить его id в `.env`, сделать бота администратором в этом канале.
3. Запустить бота командой:
```
python manage.py bot
```

Теперь можно написать боту команду `/start` и заказать тортики себе, маме и друзьям!


## Цели проекта
Код написан в рамках выполнения командного проекта в формате фриланс-заказа.
